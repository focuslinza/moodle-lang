<!-- $Id$ -->

<h1>Importer des fichiers « Course Test Manager »</h1>

<p>Course Test Manager est un logiciel en fin de vie de l'entreprise Course Technology. Il n'est plus développé, car il a été remplacé par un autre produit appelé ExamView. Cependant aucun moyen n'a mis été à disposition pour permettre de transférer les tests CTM vers d'autres format de tests. C'est la raison d'être de ce module.</p>

<p>Pour importer des questions depuis CTM, votre machine Windows doit avoir CTM installé et avoir accès aux fichiers de données MS Access sur cette machine. Deux fichiers de données sont requis :</p>

<ul>

<li>System.mda - ce fichier est situé dans le dossier principal de votre installation de CTM. Dans le jargon de MS access, il est nommé la « System Database ».</li>

<li>ctm.mdb - c'est la base de données contenant les questions. Il y a une telle base de données pour chaque cours installé dans CTM. Ce fichier est situé dans un dossier au niveau immédiatement inférieur de votre dossier CTM.</li>

</ul>

<p>Le processus d'importation est quelque peu différent, selon que vous utilisez Moodle sous Windows ou Linux. Dans tous les cas, il vous faudra une machine Windows (Windows 200 ou XP) sur le même réseau que votre machine Moodle pour héberger les bases de données Access durant l'importation des questions.</p>

<p>L'importation sera plus facile sur un Moodle tournant sous <strong>Windows</strong>. Les étapes sont les suivantes :</p>

<ol>

<li>Déposer le fichier system.mda dans Moodle à l'aide du gestionnaire de fichiers, dans n'importe quel cours. Moodle le trouvera de toute façon.</li>

<li>Créer un nouveau test et sélectionnez « Importer les questions d'un fichier ». Choisissez votre fichier ctm.mdb comme fichier à télécharger. Si vous n'abez pas fait d'erreurs, une page s'affichera vous demandant de choisir la sous-catégorie des questions à importer de la base de données. Cette étape est nécessaire, car bon nombre de tests CTM comportent beaucoup de questions en différentes catégories.</li>

</ol>

<p>L'importation sur un Moodle tournant sous <strong>Linux</strong> requiert un logiciel supplémentaire appelé <a href="http://odbcsock.sourceforge.net/" ><strong>ODBC Socket Server</strong></a>. Afin d'importer des questions CTM sur Linux, vous devez d'abord télécharger et installer ce petit programme sur le système Windows hébergeant les bases de données CTM. <strong>Ne suivez pas</strong> les instructions d'installation données dans ODBC Socket Server Installation. Elles sont plus compliquées que nécessaires ! Suivez plutôt les étapes suivantes :</p>

<ol>

<li>Décompactez et installez sur la machine Windows le fichier que vous avez téléchargé sur <a href="http://odbcsock.sourceforge.net/" >ce site</a>.</li>

<li>Copier l'exécutable ODBCSocketServer.exe dans un dossier, par exemple votre dossier système (vraisemblablement C:\WINNT\ ou C:\Windows) ou dans votre dossier Program Files.</li>

<li>Installez le ODBC Socket Server comme un Service sur le système Windows avec la commande :<br />

<strong><chemin du fichier ci-dessus>ODBCSocketServer.exe /Service</strong><br />

Vous pouvez faire cela en tapant la commande depuis le menu Démarrer->Commande... ou une fenêtre terminal.</li>

<li>Ouvrez le Service Manager soit depuis le menu Démarrer->Settings->Control Panels->Administrative Tools->Services ou en cliquant avec le bouton droit de la souris sur <strong>Mon ordinateur</strong>, en sélectionnant <strong>Administrer</strong>, puis en choisissant <strong>Services et Applications->Services</strong>. Le Gestionnaire de Services est aussi accessible en tapant <strong>services.msc</strong> depuis le menu Démarrer->Commande...</li>

<li>Dans le Gestionnaire de Services, cliquez avec le bouton droit de la souris sur ODBC Socket Server et sélectionnez « Démarrer ». Le statut devrait changer en indiquant que le service a démarré. Après l'importation, vous pourrez arrêter ou désactiver complètement ce service.</li>

<li>Assurez-vous que les fichiers system.mda et ctm.mdb sont bien sur la machine et que le pilote MS Access ODBC est installé (c'est le cas dans une installation standard de Windows). Vous pouvez vérifier cela en ouvrant « Sources de données » dans les Outils d'Administration, sur l'onglet « Pilotes ». Vous allez devoir indiquer où CTM est installé et l'endroit où sont les fichiers system.mda et ctm.mdb ou d'autres bases de données que vous désirez importer. Mettez par écrit les chemins d'accès complets de ces fichiers, ainsi que de l'adresse IP ou du nom de cette machine Windows. Ces informations seront utilisées lors de l'importation.</li>

<li>Vous pouvez maintenant importer les questions désirées dans Moodle. Créer un nouveau test et sélectionnez « Importer les questions d'un fichier ». <strong>À PARTIR D'ICI, LE PROCESSUS EST DIFFÉRENT SOUS LINUX -</strong> VOUS DEVEZ SPÉCIFIER UN NOM DE FICHIER BIDON POUR DÉMARRER LE PROCESSUS D'IMPORTATION. CE FICHIER BIDON <strong>NE SERA EN FAIT PAS IMPORTÉ</strong>, IL S'AGIT SEULEMENT D'UN EMPLACEMENT QUI VOUS PERMETTRA DE SPÉCIFIER LES INFORMATIONS DU SERVEUR WINDOWS. Une page s'affichera ensuite où vous pouvez taper l'adresse IP ou le nom du serveur Windows ainsi que les chemins des différents fichiers que vous avez relevés à l'étape précédente. Tapez ces informations et cliquez sur « Connexion au serveur ». Si aucune erreur n'a été faite, un autre formulaire vous permettra de choisir la sous-catégorie des questions à importer de la base de données. Cette étape est nécessaire, car bon nombre de tests CTM comportent beaucoup de questions en différentes catégories. SI VOUS ARRIVEZ ICI SANS MESSAGE D'ERREUR, VOTRE SERVEUR EST CONFIGURÉ CORRECTEMENT ET VOUS COMMENCEZ À IMPORTER DES QUESTIONS DANS MOODLE !</li>

</ol>

<p>Si vous avez obtenu des messages d'erreur durant ce processus, les informations suivantes vous seront peut-être utiles. Le serveur ODBC Socket utilise le port 9628 et échange une requête XML avec une table de résultats à la requête XML. La classe d'importation balaie ce XML et l'utilise comme un requête locale pour effectuer l'importation.</p>