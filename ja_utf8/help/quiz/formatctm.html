<h1>Course Test Managerファイルのインポート</h1>
<p>Course Test ManagerはCourse Technology社による「存続期間を終了した」ソフトウェアパッケージです。
現在、Course Technology社により、積極的には開発されていません。
Course Test ManagerはExamViewと呼ばれる新たなテストマネージャに入れ替えられました。
しかし、CTMテストバンクからエクスポートされたフォーマットを、他の一般的なフォーマットに移管する方法が存在しません。
そのため、このモジュールが開発されました。</p>

<p>CTMから問題をインポートするには、あなたのWindowsマシンにCTMをインストールして、そのマシンのMS Accessデータベースにアクセスできるようにする必要があります。
データファイルにアクセスするには、2つのデータファイルが必要です:</p>
<ul><li>System.mda - このファイルはあなたのCTMのトップディレクトリに置かれ、MSアクセス用語「System Database」にて参照することができます。</li>
<li>ctm.mdb - このファイルはテストバンクの問題を含むデータベースです。CTMにインストールされたコースそれぞれに、これらのデータベースが配置されます。あなたのインストール済みCTMの1レベル下のディレクトリに配置されます。</li>
</ul>

</p>あなたがMoodleをWindowsまたはLinuxのどちらで動作させているかにより、インポートプロセスは若干異なります。
どのようなプラットフォームでMoodleが動作しているかに係わらず、テストバンクのインポート中、Accessデータベースを使用するため、あなたのMoodleシステムと同じネットワーク上にWindowsシステム (Windows 2000またはWindows XP) を配置する必要があります。</p>

<p><b>Windowsベース</b>のMoodleシステムの場合、プロセスは若干容易になります。
CTMインポートクラスを使用する上で、あなたに必要なことは以下のとおりです:</p>

<ol><li>ファイルマネージャを使用して、system.mdaシステムデータベースをMoodleにアップロードします。
あなたがsystem.mdaをアップロードするのはどのコースでもかまいません。アップロードされた場所に係わらず、Moodleがsystem.mdaを探し出します。</li>
<li>あなたの小テストを作成した後、「ファイルから問題をインポートする」ページにアクセスします。インポートするファイルとして、あなたが選択したctm.mdbデータベースをアップロードしてください。
この作業に成功した場合、データベースからインポートするための、あなたが選択することのできる問題サブカテゴリが表示されます。
このステップが存在する理由はしばしばCTMテストバンクが、本の章またはコースセクションをベースとした多数の問題カテゴリを含むからです。</li>
</ol>

<p><b>Linuxベース</b>のMoodleシステムの場合、CTMデータベースをインポートするには、<a href="http://odbcsock.sourceforge.net/" target="_new"><b>ODBCソケットサーバ</b></a>と呼ばれる、サードパーティのソフトウェアコンポーネントをインストールする必要があります。
CTMデータベースをLinuxにインポートするには、最初に、あなたのCTMデータベースを含むWindowsシステムに、この小さなネットワークプログラムをダウンロードおよびインストールする必要があります。
ODBCソケットサーバのインストールで言及されるインストールステップに<b>従わないでください</b>。
それらのステップは必要以上に複雑になっています! 
あなたのWindowsシステムに、このプログラムをインストールするには、代わりに、以下のステップに従ってください:</p>

<ol><li>Windowsシステムに入って、あなたが<a href="http://odbcsock.sourceforge.net/" target="_new">このサイト</a>からシステムにダウンロードしたファイルを解凍してください。</li>
<li>あなたの永続的なディレクトリ、システムディレクトリ (恐らく、C:\WINNT\ または C:\Windows) またはProgram Filesディレクトリ内に、ODBCSocketServer.exeバイナリを入れてください。</li>

<li>以下のコマンドにより、システムのサービスとして、ODBCソケットサーバをインストールしてください:<br />
<b>&lt;上記ステップで、あなたがファイルをコピーしたパス&gt;ODBCSocketServer.exe /Service</b><br />
あなたはこのコマンドを「スタート-&gt;ファイル名を指定して実行 ...」、またはコマンドプロンプトにより、実行することができます。</li>

<li>「スタート-&gt;設定-&gt;コントロールパネル-&gt;管理ツール-&gt;サービス」または「マイ コンピュータ」上で右クリックすることで、
サービスマネージャを開いてください。そして、右側のパネルから、<b>サービスとアプリケーション-&gt;サービス</b>を選択してください。
あなたは「スタート-&gt;ファイル名を指定して実行 ...」にて、<b>services.msc</b>とタイプすることにより、サービスマネージャにアクセスすることもできます。</li>

<li>サービスマネージャ内のODBCソケットサーバ上で右クリックして、<b>スタート</b>アイテムを選択してください。
あなたが選択した場合、ステータスが「開始」に変更されます。
インポート処理を終了した後、あなたはこのサービスを完全に停止または無効にすることができます。</li>

<li>system.mdaおよびctm.mdb Accessデータファイルがマシン上にあり、MS Access ODBCドライバが存在していることを確認してください。
これは標準的なWindowsにインストールされています。
あなたは「管理ツール」内の「データソース」アイテムを開いて、「ドライバ」タブをクリックすることにより、MS Access ODBCドライバがインストールされているかどうか確認することができます。
あなたはどこにCTMをインストールするか、system.mdaファイルおよびctm.mdaデータベースをどこに置くか、またはデータをインポートしたいデータベースを決定する必要があります。
WindowsサーバのIPアドレスまたはホスト名と同様に、これらのファイルへのローカルパスも記録してください。</li>

<li>これで、あなたはMoodleにテストバンクをインポートすることができるようになります。
あなたの小テストを作成して、「ファイルから問題をインポートする」処理に移動してください。
<b>ここからはLINUXで異なる部分です - </b> インポート処理を開始するため、あなたはアップロードフィールドでダミーファイルを指定する必要があります。
このファイルは<b>処理されず</b>、インポートフォームの仮の入力値 (placeholder) となるだけです。
次にあなたはWindowsサーバ情報を指定する場所へ移動します。そして、次にあなたはシステムおよびテストバンクデータベースのパスと同様に
Windows ODBCソケットサーバマシンのホスト名を入力することができます。
あなたが前のステップで入力した情報をここに入力して、「サーバに接続する」をクリックしてください。 
すべてが正しく設定された場合、あなたがデータベースからインポートすることのできる、問題サブカテゴリを選択するフォームが表示されます。
このステップが存在する理由はしばしばCTMテストバンクが、本の章またはコースセクションをベースとした多数の問題カテゴリを含むからです。
このステップにエラーなしに到達できた場合、あなたはソケットサーバを正しく設定できています。そして、あなたはMoodleに問題をインポートすることができます!</li>
</ol>

<p>この処理中にエラーメッセージが表示された場合、この技術情報が有益だと理解できるでしょう。
クエリがクエリ結果用のXML結果テーブルを利用できるようにするため、ODBCソケットサーバはXMLソケットのオープンにポート9628を使用します。
インポートクラスは私がインポートするために使用するローカルクエリのように、XMLを構文解析して使用します。
</p>
